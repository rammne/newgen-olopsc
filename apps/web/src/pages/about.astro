---
import Layout from "../layouts/Layout.astro";
import Hero from "../components/homepage/Hero.astro";
import Stats from "../components/homepage/Stats.astro";
import FinalCta from "../components/homepage/FinalCta.astro";
import ScrollRevealWrapper from "../components/common/ScrollRevealWrapper.astro";
import IdentitySection from "../components/about/IdentitySection.astro";
import MissionVisionValues from "../components/about/MissionVisionValues.astro";
import TenPointAgenda from "../components/about/TenPointAgenda.astro";
import HistorySection from "../components/about/HistorySection.astro";
import LeadershipSection from "../components/about/LeadershipSection.astro";
import AccreditationsSection from "../components/about/AccreditationsSection.astro";
import { getAboutPage } from "../lib/sanity/queries";
import "../styles/global.css";

// Fetch about page data
const aboutPage = await getAboutPage();

// Set page title from SEO or default
const pageTitle = aboutPage?.seo?.title || aboutPage?.title || "About Us";
const pageDescription =
    aboutPage?.seo?.description ||
    "Learn more about OLOPSC history, mission, and vision.";
---

<Layout title={pageTitle} description={pageDescription}>
    {aboutPage?.hero && <Hero hero={aboutPage.hero} />}

    {
        aboutPage?.identity && (
            <ScrollRevealWrapper direction="up" delay={0.1}>
                <IdentitySection identity={aboutPage.identity} />
            </ScrollRevealWrapper>
        )
    }

    {
        (aboutPage?.mission || aboutPage?.vision || aboutPage?.values) && (
            <ScrollRevealWrapper direction="up" delay={0.1}>
                <MissionVisionValues
                    mission={aboutPage?.mission}
                    vision={aboutPage?.vision}
                    values={aboutPage?.values}
                />
            </ScrollRevealWrapper>
        )
    }

    {
        aboutPage?.strategicAgenda && (
            <ScrollRevealWrapper direction="up" delay={0.1}>
                <TenPointAgenda agenda={aboutPage.strategicAgenda} />
            </ScrollRevealWrapper>
        )
    }

    {
        aboutPage?.history && (
            <ScrollRevealWrapper direction="up" delay={0.1}>
                <HistorySection history={aboutPage.history} />
            </ScrollRevealWrapper>
        )
    }

    {
        aboutPage?.stats && aboutPage.stats.length > 0 && (
            <ScrollRevealWrapper direction="up" delay={0.1}>
                <Stats
                    keyStats={{
                        stats: aboutPage.stats,
                        backgroundImage: aboutPage.hero?.backgroundImage,
                    }}
                />
            </ScrollRevealWrapper>
        )
    }

    {
        aboutPage?.leadership && (
            <ScrollRevealWrapper direction="up" delay={0.1}>
                <LeadershipSection leadership={aboutPage.leadership} />
            </ScrollRevealWrapper>
        )
    }

    {
        aboutPage?.accreditations && (
            <ScrollRevealWrapper direction="up" delay={0.1}>
                <AccreditationsSection
                    accreditations={aboutPage.accreditations}
                />
            </ScrollRevealWrapper>
        )
    }

    {
        aboutPage?.cta && (
            <ScrollRevealWrapper direction="fade" delay={0.1}>
                {/* Reusing FinalCta but mapping the single CTA object to what FinalCta expects or using it as Primary CTA */}
                <FinalCta
                    finalCta={{
                        headline: "Join the OLOPSC Community",
                        subheadline:
                            "Be part of our growing family aimed at excellence.",
                        primaryCta: aboutPage.cta,
                        backgroundImage: aboutPage.hero?.backgroundImage, // Fallback to hero image if needed, or specific one
                    }}
                />
            </ScrollRevealWrapper>
        )
    }
</Layout>
