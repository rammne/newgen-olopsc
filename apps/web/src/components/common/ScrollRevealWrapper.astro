---
interface Props {
  class?: string
  delay?: number
  direction?: 'up' | 'down' | 'left' | 'right' | 'fade'
  duration?: number
  distance?: number
}

const {
  class: className = '',
  delay = 0,
  direction = 'up',
  duration = 0.8,
  distance = 60,
} = Astro.props

const translateMap = {
  up: `translateY(${distance}px)`,
  down: `translateY(-${distance}px)`,
  left: `translateX(${distance}px)`,
  right: `translateX(-${distance}px)`,
  fade: 'none'
}
---

<div
  class={`scroll-reveal ${className}`}
  data-direction={direction}
  style={`
    opacity: 0;
    transform: ${translateMap[direction]};
    transition: opacity ${duration}s cubic-bezier(0.22, 0.61, 0.36, 1), transform ${duration}s cubic-bezier(0.22, 0.61, 0.36, 1);
    transition-delay: ${delay}s;
  `}
>
  <slot />
</div>

<script>
  const observerOptions = {
    threshold: 0.1,
    rootMargin: '0px 0px -50px 0px'
  };

  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        const el = entry.target as HTMLElement;
        el.style.opacity = '1';
        el.style.transform = 'translate(0, 0)';
        observer.unobserve(el);
      }
    });
  }, observerOptions);

  document.addEventListener('DOMContentLoaded', () => {
    document.querySelectorAll('.scroll-reveal').forEach(el => observer.observe(el));
  });
</script>
