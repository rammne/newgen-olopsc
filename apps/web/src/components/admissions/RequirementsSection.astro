---
import { PortableText } from "astro-portabletext";
import { CheckCircle2, ChevronRight } from "lucide-astro";

interface Props {
    requirements: {
        title?: string;
        content?: any;
        requirementsList?: string[];
    };
    departmentRequirements: {
        title?: string;
        departments?: Array<{
            department?: {
                title?: string;
                slug?: {
                    current?: string;
                };
            };
            requirements?: string[];
            additionalInfo?: any;
        }>;
    };
}

const { requirements, departmentRequirements } = Astro.props;

if (!requirements && !departmentRequirements) return null;
---

<section
    class="min-h-[60vh] px-5 py-10 sm:px-[60px] sm:py-[100px] bg-[var(--color-neutral)]/30"
>
    <div class="container mx-auto">
        {/* General Requirements */}
        {
            requirements && (
                <div class="mb-16">
                    <h2 class="text-section-header-mobile sm:text-section-header-desktop font-serif text-[var(--color-primary)] mb-8 text-center">
                        {requirements.title || "General Requirements"}
                    </h2>

                    <div class="bg-white p-8 rounded-2xl shadow-sm max-w-4xl mx-auto">
                        {requirements.content && (
                            <div class="prose prose-lg text-gray-700 mb-8">
                                <PortableText value={requirements.content} />
                            </div>
                        )}

                        {requirements.requirementsList && (
                            <ul class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                {requirements.requirementsList.map((req) => (
                                    <li class="flex items-start gap-3">
                                        <CheckCircle2
                                            size={20}
                                            class="text-[var(--color-accent)] mt-1 flex-shrink-0"
                                        />
                                        <span class="text-gray-700">{req}</span>
                                    </li>
                                ))}
                            </ul>
                        )}
                    </div>
                </div>
            )
        }

        {/* Department Specific Requirements */}
        {
            departmentRequirements && departmentRequirements.departments && (
                <div>
                    <h3 class="text-2xl sm:text-3xl font-serif text-[var(--color-primary)] mb-10 text-center">
                        {departmentRequirements.title ||
                            "Department Specific Requirements"}
                    </h3>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        {departmentRequirements.departments.map((dept) => (
                            <div class="bg-white border-l-4 border-[var(--color-primary)] p-6 rounded-r-xl shadow-sm hover:shadow-md transition-shadow">
                                <h4 class="text-xl font-bold text-[var(--color-primary)] mb-4 flex items-center justify-between">
                                    {dept.department?.title}
                                    {dept.department?.slug?.current && (
                                        <a
                                            href={`/${dept.department.slug.current}`}
                                            class="text-xs font-normal text-[var(--color-accent)] hover:underline flex items-center gap-1"
                                        >
                                            View Program{" "}
                                            <ChevronRight size={14} />
                                        </a>
                                    )}
                                </h4>

                                {dept.requirements && (
                                    <ul class="space-y-2 mb-4">
                                        {dept.requirements.map((req) => (
                                            <li class="flex items-start gap-2 text-sm text-gray-700">
                                                <div class="w-1.5 h-1.5 rounded-full bg-[var(--color-primary)]/40 mt-1.5 mr-1 flex-shrink-0" />
                                                {req}
                                            </li>
                                        ))}
                                    </ul>
                                )}

                                {dept.additionalInfo && (
                                    <div class="text-sm text-gray-600 border-t pt-4 mt-4 italic">
                                        <PortableText
                                            value={dept.additionalInfo}
                                        />
                                    </div>
                                )}
                            </div>
                        ))}
                    </div>
                </div>
            )
        }
    </div>
</section>
